<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- MODIFIED TITLE -->
    <title>Hyponatremia Diagnostic Aid</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Basic Reset and Font */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background-color: #f1f5f9; /* Equivalent to bg-slate-100 */
            padding: 20px; /* Replaces body p-4 */
        }

        /* Main Container */
        .main-container {
            max-width: 896px; /* Approx max-w-4xl */
            margin: 20px auto;
            background: linear-gradient(to bottom, white, #f8fafc); /* from-white to-slate-50 */
            padding: 24px; /* p-6 */
            border-radius: 12px; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl (approximation) */
            border: 1px solid #e2e8f0; /* border-slate-200 */
        }

        /* Headings and Text */
        h1 {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 700; /* font-bold */
            color: #1e293b; /* text-slate-800 */
            margin-bottom: 0.5rem; /* mb-2 */
            text-align: center;
            padding-bottom: 10px;
             border-bottom: 1px solid #eee;
        }

        .subtitle {
            font-size: 1rem; /* text-base */
            color: #475569; /* text-slate-600 */
            margin-bottom: 2rem; /* mb-8 */
            text-align: center;
        }

        /* Form Styling */
        form {
            /* space-y-6 handled by fieldset margin */
        }

        fieldset {
            border: 1px solid #e2e8f0; /* border-slate-200 */
            padding: 20px; /* p-5 */
            border-radius: 8px; /* rounded-lg */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
            background-color: white; /* bg-white */
            margin-bottom: 1.5rem; /* Replacement for form space-y-6 */
        }

        legend {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            color: #1e293b; /* text-slate-800 */
            padding: 0 8px; /* px-2 */
            margin-left: -8px; /* -ml-2 */
            margin-bottom: 15px;
        }

        /* Grid Layout for Inputs */
        .input-grid {
            display: grid;
            grid-template-columns: 1fr; /* grid-cols-1 */
            gap: 20px 24px; /* gap-y-5 gap-x-6 */
            margin-top: 12px; /* mt-3 */
        }
         /* Added 3-column grid for wider screens */
        @media (min-width: 1024px) { /* lg breakpoint */
            .input-grid {
                grid-template-columns: repeat(3, 1fr); /* lg:grid-cols-3 */
            }
        }


        /* Labels */
        label {
            display: block;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #334155; /* text-slate-700 */
            margin-bottom: 4px; /* mb-1 */
        }

        /* Select Inputs */
        select {
            margin-top: 4px; /* mt-1 */
            display: block;
            width: 100%;
            border-radius: 6px; /* rounded-md */
            border: 1px solid #cbd5e1; /* border-slate-300 */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
            padding: 10px; /* p-2.5 */
            background-color: white; /* bg-white */
            color: #0f172a; /* text-slate-900 */
            font-size: 0.875rem; /* sm:text-sm */
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }
        select:focus {
            border-color: #3b82f6; /* focus:border-blue-500 */
            outline: 1px solid #3b82f6; /* Simple focus ring */
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); /* focus:ring approximation */
        }

        /* Button Container */
        .button-container {
            margin-top: 2rem; /* mt-8 */
            padding: 1.5rem 1rem 1rem 1rem; /* pt-6 pb-4 px-4 */
            background-color: #f8fafc; /* bg-slate-50 */
            border: 1px solid #e2e8f0; /* border-slate-200 */
            border-radius: 8px; /* rounded-lg */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
        }
        .button-wrapper {
             display: flex;
             justify-content: center;
             gap: 1rem; /* Replacement for space-x-4 */
        }

        /* Buttons */
        button {
            padding: 10px 15px; /* px-6 py-2.5 adjusted */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            border-radius: 6px; /* rounded-md */
            border: none; /* Added */
            cursor: pointer;
            transition: background-color 0.15s ease-in-out;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
        }
        button:focus {
             outline: 2px solid transparent; /* focus:outline-none */
             outline-offset: 2px;
             box-shadow: 0 0 0 3px rgba(100, 116, 139, 0.5); /* focus:ring approximation */
        }
        button:disabled {
            opacity: 0.6; /* disabled:opacity-60 */
            cursor: not-allowed; /* disabled:cursor-not-allowed */
        }

        /* Primary Button (Interpret) */
        #interpret-btn {
            background-color: #2563eb; /* bg-blue-600 */
            color: white; /* text-white */
        }
        #interpret-btn:hover {
            background-color: #1d4ed8; /* hover:bg-blue-700 */
        }
         #interpret-btn:focus {
             box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); /* focus:ring-blue-500 */
         }

        /* Secondary Button (Reset) */
        #reset-btn {
            background-color: #e2e8f0; /* bg-slate-200 */
            color: #1e293b; /* text-slate-800 */
        }
        #reset-btn:hover {
            background-color: #cbd5e1; /* hover:bg-slate-300 */
        }
         #reset-btn:focus {
              box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.5); /* focus:ring-slate-400 */
         }

        /* Results Area */
        #result {
            margin-top: 2rem; /* mt-8 */
            padding: 1.5rem; /* p-6 */
            background-color: #eff6ff; /* bg-blue-50 */
            border: 1px solid #93c5fd; /* border-blue-300 */
            border-radius: 8px; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
            display: none; /* Initially hidden */
        }
        #result > div {
            margin-bottom: 1rem; /* space-y-4 */
        }
        #result > div:last-child {
            margin-bottom: 0;
        }

        .result-label {
            font-size: 0.875rem; /* text-sm */
            font-weight: 600; /* font-semibold - increased weight */
            color: #1e40af; /* text-blue-800 */
            text-transform: uppercase; /* uppercase */
            letter-spacing: 0.05em; /* tracking-wider */
            display: block; /* Ensure it's on its own line */
            margin-bottom: 6px; /* Increased margin */
        }

        /* MODIFIED RESULT DISPLAYS */
        #classification-display { /* Replaces interpretation */
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            color: #1d4ed8; /* text-blue-700 */
            margin-bottom: 0.5rem; /* Added spacing */
        }

        #differential-display { /* Replaces phase-stage */
             font-size: 1rem; /* text-base */
             font-weight: 500; /* font-medium */
             color: #2563eb; /* text-blue-600 */
        }
        /* Added specific styling for nested lists in results */
        #differential-display ul, #notes-display ul {
            list-style-position: outside; /* Standard bullet outside text */
            list-style-type: disc;
            margin-top: 0.5rem;
            padding-left: 1.25rem; /* Indent lists */
        }
         #differential-display ul ul, #notes-display ul ul { /* Nested lists */
            list-style-type: circle; /* Different bullet for nested */
            margin-left: 1.25rem; /* Further indent nested lists */
            margin-top: 0.25rem;
         }
         #differential-display li, #notes-display li {
            margin-bottom: 0.35rem; /* space-y-1.5 between items */
         }


        #notes-display { /* Replaces recommendations */
            font-size: 0.875rem; /* text-sm */
            color: #334155; /* text-slate-700 */
            line-height: 1.65; /* leading-relaxed */
        }

        .disclaimer {
             margin-top: 1.25rem; /* mt-5 */
             font-size: 0.75rem; /* text-xs */
             color: #64748b; /* text-slate-500 */
             border-top: 1px solid #e2e8f0; /* border-t border-slate-200 */
             padding-top: 0.75rem; /* pt-3 */
             font-style: italic;
        }
         .disclaimer strong {
            font-style: normal; /* Reset italic for strong tag */
         }

        /* Responsive Grid */
        @media (min-width: 768px) { /* md breakpoint */
            body {
                padding: 40px; /* Replaces md:p-8 */
            }
            .main-container {
                 padding: 32px; /* md:p-8 */
            }
             .input-grid {
                grid-template-columns: repeat(2, 1fr); /* md:grid-cols-2 */
             }
        }
        @media (min-width: 1024px) { /* lg breakpoint */
            .input-grid {
                grid-template-columns: repeat(3, 1fr); /* lg:grid-cols-3 */
            }
        }


    </style>
</head>
<body>

    <div class="main-container">
        <!-- MODIFIED HEADINGS -->
        <h1>Hyponatremia Diagnostic Aid</h1>
        <p class="subtitle">Enter clinical and lab parameters to help differentiate causes of hyponatremia.</p>

        <form id="hyponatremia-form"> <!-- MODIFIED ID -->

            <fieldset>
                <legend>Diagnostic Parameters</legend>
                <div class="input-grid">
                    <!-- NEW INPUTS FOR HYPONATREMIA -->
                    <div>
                        <label for="serum_osm">Serum Osmolality (Sosm):</label>
                        <select id="serum_osm" name="serum_osm">
                            <option value="na">Not Available</option>
                            <option value="low_lt_275">Low (< 275 mOsm/kg)</option>
                            <option value="normal_275_295">Normal (275-295 mOsm/kg)</option>
                            <option value="high_gt_295">High (> 295 mOsm/kg)</option>
                        </select>
                    </div>
                     <div>
                        <label for="volume_status">Clinical Volume Status:</label>
                        <select id="volume_status" name="volume_status">
                            <option value="na">Not Assessed / Unclear</option>
                            <option value="Hypovolemic">Hypovolemic (Dehydrated)</option>
                            <option value="Euvolemic">Euvolemic (Normal Volume)</option>
                            <option value="Hypervolemic">Hypervolemic (Fluid Overload)</option>
                        </select>
                    </div>
                     <div>
                        <label for="urine_osm">Urine Osmolality (Uosm):</label>
                        <select id="urine_osm" name="urine_osm">
                            <option value="na">Not Available</option>
                            <option value="low_lt_100">Low (< 100 mOsm/kg)</option>
                            <option value="intermediate_100_300">Intermediate (100-300 mOsm/kg)</option>
                            <option value="high_gt_300">High (> 300 mOsm/kg)</option>
                            <option value="high_gt_sosm">High (> Serum Osmolality)</option> <!-- Added for SIADH clarity -->
                        </select>
                    </div>
                    <div>
                        <label for="urine_na">Urine Sodium (UNa):</label>
                        <select id="urine_na" name="urine_na">
                            <option value="na">Not Available</option>
                            <option value="low_lt_20">Low (< 20 mEq/L)</option>
                             <option value="intermediate_20_40">Intermediate (20-40 mEq/L)</option>
                            <option value="high_gt_40">High (> 40 mEq/L)</option>
                        </select>
                    </div>
                     <div>
                        <label for="urine_sg">Urine Specific Gravity (USG):</label>
                        <select id="urine_sg" name="urine_sg">
                            <option value="na">Not Available</option>
                            <option value="low_lt_1005">Low (< 1.005)</option>
                            <option value="intermediate_1005_1010">Intermediate (1.005 - 1.010)</option>
                            <option value="high_gt_1010">High (> 1.010)</option>
                        </select>
                    </div>
                     <div>
                         <label for="diuretic_use">Recent Diuretic Use?</label>
                         <select id="diuretic_use" name="diuretic_use">
                             <option value="no">No</option>
                             <option value="yes">Yes</option>
                             <option value="unknown">Unknown</option>
                         </select>
                     </div>

                </div>
            </fieldset>

            <div class="button-container">
                <div class="button-wrapper">
                    <!-- MODIFIED BUTTON ID -->
                    <button type="button" id="interpret-btn">Interpret Parameters</button>
                    <button type="reset" id="reset-btn">Reset Form</button>
                </div>
            </div>

        </form>

        <!-- MODIFIED RESULT AREA -->
        <div id="result">
            <div>
                <p class="result-label">Classification:</p>
                <p id="classification-display"></p>
            </div>
             <div>
                 <p class="result-label">Potential Causes / Differential Diagnosis:</p>
                 <div id="differential-display">
                     {/* Differential diagnoses will be inserted here by JS */}
                 </div>
             </div>
             <div>
                 <p class="result-label">Key Findings & Notes:</p>
                 <div id="notes-display">
                    {/* Notes will be inserted here by JS */}
                 </div>
             </div>
             <!-- MODIFIED DISCLAIMER -->
             <p class="disclaimer">
                <strong>Disclaimer:</strong> This tool provides potential interpretations based on common diagnostic algorithms for hyponatremia. Results <strong>must</strong> be interpreted in the full clinical context (history, medications, physical exam) by a qualified healthcare professional. This tool does not replace clinical judgment, consider atypical presentations, or account for all possible causes or medication effects. Always refer to current clinical practice guidelines.
            </p>
        </div>
    </div>

    <!-- START OF UPDATED SCRIPT SECTION -->
    <script>
        // Get references to form elements (MODIFIED IDs)
        const form = document.getElementById('hyponatremia-form');
        const serumOsmSelect = document.getElementById('serum_osm');
        const volumeStatusSelect = document.getElementById('volume_status');
        const urineOsmSelect = document.getElementById('urine_osm');
        const urineNaSelect = document.getElementById('urine_na');
        const urineSgSelect = document.getElementById('urine_sg');
        const diureticUseSelect = document.getElementById('diuretic_use'); // Added diuretic input

        const interpretBtn = document.getElementById('interpret-btn');
        const resetBtn = document.getElementById('reset-btn');
        const resultDiv = document.getElementById('result');
        // MODIFIED RESULT DISPLAY IDs
        const classificationDisplay = document.getElementById('classification-display');
        const differentialDisplay = document.getElementById('differential-display');
        const notesDisplay = document.getElementById('notes-display');

        // --- Interpretation Logic ---
        // RENAMED FUNCTION
        function interpretHyponatremia() {
            // Read input values
            const sosm = serumOsmSelect.value;
            const volume = volumeStatusSelect.value;
            const uosm = urineOsmSelect.value;
            const una = urineNaSelect.value;
            const usg = urineSgSelect.value;
            const diureticUse = diureticUseSelect.value;

            let classification = 'Requires Assessment';
            let differential = ['<ul><li>Unable to determine differential with provided data.</li></ul>']; // Start with default list
            let notes = ['<ul><li>Clinical correlation is essential. Evaluate patient history, medications, and perform a thorough physical exam.</li>']; // Start with default list

            // --- Core Logic based on Diagnostic Algorithm ---

            // Step 1: Check Serum Osmolality
            if (sosm === 'na') {
                classification = 'Serum Osmolality Required';
                differential = ['<ul><li>Cannot classify hyponatremia type without Serum Osmolality.</li></ul>'];
                notes.push('<li>Measure Serum Osmolality to confirm true hypotonic hyponatremia vs. pseudohyponatremia or hypertonic hyponatremia.</li>');
            } else if (sosm === 'normal_275_295') {
                classification = 'Isotonic Hyponatremia (Pseudohyponatremia)';
                differential = ['<ul><li>Severe Hyperlipidemia</li><li>Severe Hyperproteinemia (e.g., IVIG, Multiple Myeloma)</li><li>Lab artifact possible with indirect ISE methods</li></ul>'];
                notes.push('<li>This occurs when high levels of lipids or proteins displace water in the plasma sample using certain lab methods (indirect ISE).</li>');
                notes.push('<li>The actual plasma tonicity and cell volume are normal.</li>');
                notes.push('<li>Confirm with direct ion-selective electrode (ISE) sodium measurement, lipid panel, or serum protein electrophoresis if suspected.</li>');
            } else if (sosm === 'high_gt_295') {
                classification = 'Hypertonic Hyponatremia';
                differential = ['<ul><li>Hyperglycemia (e.g., DKA, HHS) - Most common</li><li>Recent administration of hypertonic Mannitol</li><li>Recent administration of IVIG (sucrose-containing)</li><li>Recent high-osmolar IV contrast</li><li>Ingestion of other osmotically active substances (e.g., ethylene glycol, methanol - causing osmolar gap)</li></ul>'];
                notes.push('<li>Sodium is diluted by an osmotic shift of water from intracellular to extracellular space due to presence of other effective osmoles.</li>');
                notes.push('<li>Check blood glucose. Calculate corrected sodium for hyperglycemia: Corrected Na = Measured Na + [2.4 * (Glucose - 100) / 100].</li>');
                notes.push('<li>Consider calculating the osmolal gap if ingestion is suspected.</li>');
                notes.push('<li>Treatment involves addressing the underlying cause (e.g., managing hyperglycemia, stopping offending agent).</li>');
            } else if (sosm === 'low_lt_275') {
                // This is TRUE HYPOTONIC HYPONATREMIA - Proceed to Volume Status
                classification = 'Hypotonic Hyponatremia'; // Base classification
                notes.push('<li>True hypotonic hyponatremia confirmed (Serum Osm < 275 mOsm/kg). Water excess relative to solute.</li>');
                notes.push('<li>Further differentiation depends on clinical volume status and urine studies.</li>');

                // Step 2: Assess Volume Status (within Hypotonic Hyponatremia)
                if (volume === 'na') {
                    classification = 'Hypotonic Hyponatremia - Volume Status Needed';
                    differential = ['<ul><li>Cannot determine cause without clinical volume assessment.</li></ul>'];
                    notes.push('<li>Assess patient for signs of hypovolemia (orthostasis, tachycardia, dry mucous membranes, decreased skin turgor) or hypervolemia (edema, JVD, pulmonary rales, ascites).</li>');
                } else if (volume === 'Hypovolemic') {
                    classification = 'Hypotonic Hypovolemic Hyponatremia';
                     notes.push('<li>Patient has both water and sodium deficit, with sodium deficit being relatively greater OR significant hypotonic fluid replacement after losses.</li>');
                    notes.push('<li>ADH is appropriately stimulated by low effective circulating volume, leading to water retention and concentrated urine (Uosm usually > 300-450 mOsm/kg).</li>');
                    if (uosm === 'low_lt_100'){
                         notes.push('<li><strong style="color:orange;">Warning:</strong> Low Uosm (<100) is UNEXPECTED in true hypovolemia unless other factors are present (e.g., recent large water intake just prior to testing, resolving obstruction, potential primary polydipsia concurrent with volume loss). Re-evaluate volume status and context carefully.</li>');
                    } else if (uosm === 'na') {
                         notes.push('<li>Urine osmolality needed to confirm expected renal water retention. High Uosm is expected.</li>');
                    }

                    // Differentiate based on Urine Sodium
                    if (una === 'na') {
                         differential = ['<ul><li>Urine Na+ needed to differentiate renal vs. extra-renal source of sodium loss.</li></ul>'];
                         notes.push('<li>If diuretic use is recent/current, Urine Na+ interpretation is difficult (will be high). Consider stopping diuretic (if safe) and repeating labs, or use Fractional Excretion of Urea (FEUrea < 35% suggests hypovolemia even with diuretics).</li>');
                    } else if (una === 'low_lt_20' || una === 'intermediate_20_40') { // Grouping low/intermediate for extra-renal
                        classification = 'Hypotonic Hypovolemic Hyponatremia (Suggests Extra-renal Na+ Loss)';
                        differential = ['<ul><li><strong>Extra-renal Losses (Kidneys Conserving Na+):</strong><ul><li>Gastrointestinal losses (vomiting, diarrhea, NG suction)</li><li>Skin losses (significant sweat, burns)</li><li>Third spacing (e.g., pancreatitis, crush injury, hypoalbuminemia leading to capillary leak)</li><li>Remote diuretic or vomiting effect (after stimulus removed, but volume still low)</li></ul></li></ul>'];
                        notes.push('<li>Low UNa (<20-40 mEq/L) suggests kidneys are appropriately conserving sodium in response to volume depletion.</li>');
                         if(diureticUse === 'yes') notes.push('<li>Note: Recent diuretic use typically causes HIGH UNa. If UNa is low despite reported diuretic use, consider timing, adherence, or alternative cause of hypovolemia.</li>');
                         notes.push('<li>Treatment typically involves volume repletion with isotonic saline (0.9% NaCl). Address underlying cause of loss.</li>');
                    } else if (una === 'high_gt_40') {
                        classification = 'Hypotonic Hypovolemic Hyponatremia (Suggests Renal Na+ Loss)';
                        differential = ['<ul><li><strong>Renal Losses (Kidneys Losing Na+):</strong><ul><li><strong>Extrinsic Drivers of Renal Loss:</strong><ul><li>Diuretic Use (especially thiazides) - Very common</li><li>Primary Adrenal Insufficiency (Addison\'s: Mineralocorticoid deficiency)</li><li>Cerebral Salt Wasting (CSW - often post-neurosurgery/SAH)</li></ul></li><li><strong>Intrinsic Renal Problems:</strong><ul><li>Salt-losing nephropathies (e.g., tubulointerstitial disease, resolving ATN, post-obstructive diuresis)</li><li>Bicarbonaturia (e.g., Renal Tubular Acidosis type 2, metabolic alkalosis with vomiting)</li></ul></li></ul></li></ul>'];
                        notes.push('<li>High UNa (>40 mEq/L) in a hypovolemic state indicates kidneys are inappropriately losing sodium.</li>');
                        if(diureticUse === 'yes') {
                            notes.push('<li>Diuretic use is a very common cause. Consider this first if applicable.</li>');
                        } else {
                             notes.push('<li>If NO diuretic use, strongly consider mineralocorticoid deficiency (Primary Adrenal Insufficiency - check cortisol/ACTH/renin/aldosterone, potassium often high) or CSW (clinical context of CNS event).</li>');
                             notes.push('<li>Intrinsic salt-losing nephropathies are less common but possible, often associated with underlying kidney disease.</li>');
                        }
                         notes.push('<li>Treatment involves volume repletion (usually isotonic saline) AND addressing the underlying cause (e.g., stopping diuretic, hormone replacement for AI, specific management for CSW/renal disease).</li>');
                    }

                } else if (volume === 'Euvolemic') {
                    classification = 'Hypotonic Euvolemic Hyponatremia';
                    notes.push('<li>Patient appears clinically volume neutral (no significant edema or dehydration). Total body sodium is relatively normal, but there is an excess of total body water.</li>');

                    // Differentiate based on Urine Osmolality
                    if (uosm === 'na') {
                        differential = ['<ul><li>Urine Osmolality is crucial for differentiating euvolemic causes.</li></ul>'];
                        notes.push('<li>If Uosm < 100: Suggests ADH suppression (water overload / low solute states).</li>');
                        notes.push('<li>If Uosm > 100: Suggests ADH effect (SIADH or other endocrine causes).</li>');
                    } else if (uosm === 'low_lt_100') {
                         classification = 'Hypotonic Euvolemic Hyponatremia (Dilute Urine - ADH Appropriately Suppressed)';
                         differential = ['<ul><li>Primary Polydipsia (psychogenic or dipsogenic)</li><li>Low Solute Intake ("Beer Potomania", very low protein/salt diets like "Tea and Toast")</li><li>Reset Osmostat (rare variant, maintain lower baseline Na+)</li></ul>'];
                         notes.push('<li>Maximally dilute urine (Uosm < 100 mOsm/kg, USG often < 1.003) indicates appropriate ADH suppression by the kidneys.</li>');
                         notes.push('<li>The issue is either excessive water intake overwhelming excretion capacity (Polydipsia) OR insufficient solute intake limiting the kidney\'s ability to excrete free water (Low Solute Intake).</li>');
                         notes.push(`<li>Urine Na+ is often low (${una === 'low_lt_20' ? 'as reported' : 'typically < 20 mEq/L'}) reflecting low dietary intake, but can be variable in polydipsia depending on intake.</li>`);
                         notes.push('<li>Treatment involves addressing the underlying cause (e.g., water restriction for polydipsia, increased solute intake for low solute states).</li>');
                    } else if (uosm === 'intermediate_100_300' || uosm === 'high_gt_300' || uosm === 'high_gt_sosm') {
                        classification = 'Hypotonic Euvolemic Hyponatremia (Inappropriately Concentrated Urine - ADH Effect)';
                        differential = ['<ul><li><strong>SIADH (Syndrome of Inappropriate ADH secretion) - Diagnosis of Exclusion</strong><ul><li>Causes: CNS disorders, Pulmonary diseases, Malignancy, Drugs (SSRIs, TCAs, Carbamazepine, NSAIDs, Ecstasy etc.), Post-operative state, Pain/Nausea</li></ul></li><li><strong>Extrinsic Endocrine Causes Affecting Renal Water Handling:</strong><ul><li>Secondary Adrenal Insufficiency (ACTH deficiency - Glucocorticoid deficiency increases ADH)</li><li>Hypothyroidism (Severe - Myxedema Coma)</li></ul></li><li><strong>Other:</strong><ul><li>Exercise-associated hyponatremia (often multifactorial including ADH)</li><li>Reset Osmostat (can sometimes present with Uosm > 100)</li></ul></li></ul>'];
                        notes.push('<li>Urine is inappropriately concentrated (Uosm > 100 mOsm/kg, often > Sosm) despite low serum osmolality and euvolemia, indicating ongoing ADH effect preventing water excretion.</li>');
                        notes.push('<li><strong>SIADH is the most common cause in this category but requires excluding other possibilities.</strong></li>');
                        notes.push('<li>Must rule out secondary adrenal insufficiency (check AM cortisol / ACTH stimulation test) and severe hypothyroidism (check TSH/FT4).</li>');
                         notes.push(`<li>Urine Na+ is typically > 30-40 mEq/L (${una === 'high_gt_40' ? 'as reported' : (una === 'intermediate_20_40' ? 'intermediate, check context' : 'typically expected to be higher')}) reflecting normal volume status and sodium intake, *unless* patient is concurrently volume depleted or on a very low salt diet.</li>`);
                         if (diureticUse === 'yes') notes.push('<li><strong style="color:orange;">Caution:</strong> Thiazide diuretics can cause a euvolemic hyponatremia picture mimicking SIADH. If feasible and safe, stop thiazide and reassess labs after several days.</li>');
                        notes.push('<li>Treatment involves fluid restriction (<800-1000 mL/day often needed), addressing the underlying cause of SIADH if found, +/- salt tabs, urea, or vaptans in select cases.</li>');
                         if (uosm === 'intermediate_100_300') notes.push('<li>Uosm 100-300 mOsm/kg can be borderline; consider clinical context. It usually indicates some ADH effect but less intense than higher values. Could be resolving polydipsia or mild SIADH/endocrine issues.</li>');
                    }

                } else if (volume === 'Hypervolemic') {
                    classification = 'Hypotonic Hypervolemic Hyponatremia';
                     notes.push('<li>Patient has excess total body water AND excess total body sodium, but water excess is relatively greater, leading to dilution.</li>');
                    notes.push('<li>Clinical signs of fluid overload (edema, JVD, pulmonary congestion, ascites).</li>');
                    notes.push('<li>Mechanism often involves low effective arterial blood volume (EABV) despite total volume overload, leading to non-osmotic ADH release and RAAS activation, causing impaired water excretion and sodium retention. Urine is typically concentrated (Uosm > 100-300 mOsm/kg).</li>');
                     if (uosm === 'low_lt_100'){
                         notes.push('<li><strong style="color:orange;">Warning:</strong> Low Uosm (<100) is UNEXPECTED in typical hypervolemic states (CHF, Cirrhosis, Nephrotic Syndrome) as ADH should be active. Consider concurrent excessive free water intake (e.g., polydipsia) or alternative diagnoses. Could occur in renal failure if diluting ability preserved but concentrating ability lost.</li>');
                    } else if (uosm === 'na') {
                         notes.push('<li>Urine osmolality needed to confirm expected renal water retention (should be >100-300 mOsm/kg unless severe renal failure).</li>');
                    }

                    // Differentiate based on Urine Sodium
                     if (una === 'na') {
                         differential = ['<ul><li><strong>Causes with Avid Renal Na+ Retention (typically low UNa):</strong><ul><li>Heart Failure (CHF)</li><li>Cirrhosis</li><li>Nephrotic Syndrome</li></ul></li><li><strong>Causes with Impaired Renal Na+ Excretion (typically high UNa):</strong><ul><li>Kidney Disease (Acute Kidney Injury - AKI, or Chronic Kidney Disease - CKD)</li></ul></li></ul>'];
                         notes.push('<li>Urine Na+ helps differentiate between states where kidneys avidly retain sodium (CHF, Cirrhosis, Nephrosis) vs. states where intrinsic kidney damage prevents sodium excretion (AKI/CKD).</li>');
                     } else if (una === 'low_lt_20' || una === 'intermediate_20_40') { // Grouping low/intermediate for non-renal sodium retention
                         classification = 'Hypotonic Hypervolemic Hyponatremia (Low UNa - Suggests Avid Na+ Retention)';
                         differential = ['<ul><li><strong>States with Low Effective Arterial Blood Volume:</strong><ul><li>Heart Failure (CHF)</li><li>Cirrhosis</li><li>Nephrotic Syndrome</li></ul></li></ul>'];
                         notes.push('<li>Low UNa (<20-40 mEq/L) indicates kidneys are maximally conserving sodium due to perceived low effective circulating volume (RAAS activation), characteristic of these conditions.</li>');
                          if(diureticUse === 'yes') notes.push('<li><strong style="color:orange;">Caution:</strong> Diuretics (especially loop diuretics used in these conditions) will significantly increase UNa, masking this finding. Low UNa *despite* diuretic use suggests poor diuretic response or non-adherence. FEUrea may be helpful (<35% supports prerenal state).</li>');
                          notes.push('<li>Treatment involves fluid and sodium restriction, appropriate diuretic therapy, and management of the underlying condition (CHF, cirrhosis, nephrosis).</li>');
                     } else if (una === 'high_gt_40') {
                         classification = 'Hypotonic Hypervolemic Hyponatremia (High UNa - Suggests Impaired Renal Excretion)';
                         differential = ['<ul><li><strong>Intrinsic Renal Disease:</strong><ul><li>Acute Kidney Injury (AKI)</li><li>Chronic Kidney Disease (CKD stages 4-5)</li></ul></li></ul>'];
                         notes.push('<li>High UNa (>40 mEq/L) in a hypervolemic state suggests the kidneys themselves are damaged and cannot effectively excrete the excess sodium and water.</li>');
                         if(diureticUse === 'yes') notes.push('<li>Diuretic use also causes high UNa. Distinguishing diuretic effect from underlying renal failure requires clinical context (baseline renal function, diuretic dose/response). In advanced CKD/AKI, UNa is often high even without diuretics due to damaged tubules.</li>');
                         notes.push('<li>Urine osmolality in advanced CKD may be fixed near plasma osmolality (~300 mOsm/kg) or lower, as concentrating/diluting ability is lost (isosthenuria).</li>');
                         notes.push('<li>Treatment focuses on managing the renal failure (addressing cause if AKI, supportive care for CKD), strict fluid/sodium restriction, often requiring dialysis.</li>');
                     }
                }
            } // End of Hypotonic Logic

             // Add note about USG correlation
             if (usg !== 'na' && uosm !== 'na') {
                 let sg_uosm_match = 'consistent';
                 if ((usg === 'low_lt_1005' && uosm !== 'low_lt_100') || (usg === 'high_gt_1010' && uosm === 'low_lt_100')) {
                     sg_uosm_match = 'potentially inconsistent';
                     notes.push(`<li><strong style="color:orange;">Note:</strong> Urine Specific Gravity (${usg}) seems ${sg_uosm_match} with Urine Osmolality (${uosm}). Uosm is generally the more accurate measure of urine concentration. Discrepancies can occur with large molecules in urine (glucose, protein, contrast) which affect USG more than Uosm.</li>`);
                 } else {
                      notes.push(`<li>Urine Specific Gravity (${usg}) reported is generally consistent with the Urine Osmolality (${uosm}).</li>`);
                 }
             } else if (usg !== 'na') {
                  notes.push(`<li>Urine Specific Gravity reported: ${usg}. (Urine Osmolality provides more precise information on urine concentration).</li>`);
             }


             // Final assembly of results - Use map to add inline style for list indentation
             differentialDisplay.innerHTML = differential.join(''); // Display as is, rely on CSS for list styling
             notes.push('</ul>'); // Close the main UL for notes
             notesDisplay.innerHTML = notes.join(''); // Display as is, rely on CSS for list styling


             // Display results
             classificationDisplay.textContent = classification;
             resultDiv.style.display = 'block';
             resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }


        // --- Form Handling Logic ---
        function resetForm() {
            form.reset();
            resultDiv.style.display = 'none';
            classificationDisplay.textContent = '';
            differentialDisplay.innerHTML = '';
            notesDisplay.innerHTML = '';
             window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Event Listeners ---
        interpretBtn.addEventListener('click', interpretHyponatremia); // Use renamed function
        resetBtn.addEventListener('click', resetForm);

        // Hide results if form inputs change after interpretation
        form.addEventListener('change', () => {
            if (resultDiv.style.display !== 'none') {
                 resultDiv.style.display = 'none';
            }
        });

    </script>
    <!-- END OF UPDATED SCRIPT SECTION -->

</body>
</html>